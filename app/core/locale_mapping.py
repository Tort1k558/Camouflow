from __future__ import annotations

from typing import Final

DEFAULT_LOCALE: Final[str] = "en-US"

# Primary locale per country/territory code.
# Generated from Unicode CLDR:
# - territoryInfo languagePopulation (_populationPercent): pick the largest
# - fallback: likelySubtags for `und-CC`
#
# Notes:
# - This is a heuristic for “most common language”, not a guarantee of “official” language.
# - Some codes are territories; CLDR still provides a primary locale for most of them.
COUNTRY_TO_LOCALE: Final[dict[str, str]] = {
    # Generated mapping (ISO 3166-1 alpha-2 + XK).
    'AD': 'ca-AD',
    'AE': 'ar-AE',
    'AF': 'fa-AF',
    'AG': 'en-AG',
    'AI': 'en-AI',
    'AL': 'sq-AL',
    'AM': 'hy-AM',
    'AO': 'pt-AO',
    'AQ': 'en-AQ',
    'AR': 'es-AR',
    'AS': 'sm-AS',
    'AT': 'de-AT',
    'AU': 'en-AU',
    'AW': 'nl-AW',
    'AX': 'sv-AX',
    'AZ': 'az-AZ',
    'BA': 'bs-BA',
    'BB': 'en-BB',
    'BD': 'bn-BD',
    'BE': 'en-BE',
    'BF': 'mos-BF',
    'BG': 'bg-BG',
    'BH': 'ar-BH',
    'BI': 'rn-BI',
    'BJ': 'fr-BJ',
    'BL': 'fr-BL',
    'BM': 'en-BM',
    'BN': 'ms-BN',
    'BO': 'es-BO',
    'BQ': 'pap-BQ',
    'BR': 'pt-BR',
    'BS': 'en-BS',
    'BT': 'dz-BT',
    'BV': 'nb-BV',
    'BW': 'en-BW',
    'BY': 'be-BY',
    'BZ': 'en-BZ',
    'CA': 'en-CA',
    'CC': 'ms-CC',
    'CD': 'ln-CD',
    'CF': 'fr-CF',
    'CG': 'fr-CG',
    'CH': 'de-CH',
    'CI': 'fr-CI',
    'CK': 'en-CK',
    'CL': 'es-CL',
    'CM': 'fr-CM',
    'CN': 'zh-CN',
    'CO': 'es-CO',
    'CR': 'es-CR',
    'CU': 'es-CU',
    'CV': 'kea-CV',
    'CW': 'pap-CW',
    'CX': 'en-CX',
    'CY': 'el-CY',
    'CZ': 'cs-CZ',
    'DE': 'de-DE',
    'DJ': 'aa-DJ',
    'DK': 'da-DK',
    'DM': 'en-DM',
    'DO': 'es-DO',
    'DZ': 'ar-DZ',
    'EC': 'es-EC',
    'EE': 'et-EE',
    'EG': 'ar-EG',
    'EH': 'ar-EH',
    'ER': 'ti-ER',
    'ES': 'es-ES',
    'ET': 'am-ET',
    'FI': 'fi-FI',
    'FJ': 'en-FJ',
    'FK': 'en-FK',
    'FM': 'en-FM',
    'FO': 'fo-FO',
    'FR': 'fr-FR',
    'GA': 'fr-GA',
    'GB': 'en-GB',
    'GD': 'en-GD',
    'GE': 'ka-GE',
    'GF': 'fr-GF',
    'GG': 'en-GG',
    'GH': 'en-GH',
    'GI': 'en-GI',
    'GL': 'kl-GL',
    'GM': 'en-GM',
    'GN': 'fr-GN',
    'GP': 'fr-GP',
    'GQ': 'es-GQ',
    'GR': 'el-GR',
    'GS': 'en-GS',
    'GT': 'es-GT',
    'GU': 'en-GU',
    'GW': 'pt-GW',
    'GY': 'en-GY',
    'HK': 'zh-Hant-HK',
    'HM': 'en-HM',
    'HN': 'es-HN',
    'HR': 'hr-HR',
    'HT': 'ht-HT',
    'HU': 'hu-HU',
    'ID': 'id-ID',
    'IE': 'en-IE',
    'IL': 'he-IL',
    'IM': 'en-IM',
    'IN': 'hi-IN',
    'IO': 'en-IO',
    'IQ': 'ar-IQ',
    'IR': 'fa-IR',
    'IS': 'is-IS',
    'IT': 'it-IT',
    'JE': 'en-JE',
    'JM': 'en-JM',
    'JO': 'ar-JO',
    'JP': 'ja-JP',
    'KE': 'sw-KE',
    'KG': 'ky-KG',
    'KH': 'km-KH',
    'KI': 'en-KI',
    'KM': 'fr-KM',
    'KN': 'en-KN',
    'KP': 'ko-KP',
    'KR': 'ko-KR',
    'KW': 'ar-KW',
    'KY': 'en-KY',
    'KZ': 'ru-KZ',
    'LA': 'lo-LA',
    'LB': 'ar-LB',
    'LC': 'en-LC',
    'LI': 'de-LI',
    'LK': 'si-LK',
    'LR': 'en-LR',
    'LS': 'st-LS',
    'LT': 'lt-LT',
    'LU': 'lb-LU',
    'LV': 'lv-LV',
    'LY': 'ar-LY',
    'MA': 'ar-MA',
    'MC': 'fr-MC',
    'MD': 'ro-MD',
    'ME': 'sr-ME',
    'MF': 'fr-MF',
    'MG': 'mg-MG',
    'MH': 'mh-MH',
    'MK': 'mk-MK',
    'ML': 'bm-ML',
    'MM': 'my-MM',
    'MN': 'mn-MN',
    'MO': 'zh-Hant-MO',
    'MP': 'en-MP',
    'MQ': 'fr-MQ',
    'MR': 'ar-MR',
    'MS': 'en-MS',
    'MT': 'mt-MT',
    'MU': 'mfe-MU',
    'MV': 'dv-MV',
    'MW': 'en-MW',
    'MX': 'es-MX',
    'MY': 'ms-MY',
    'MZ': 'pt-MZ',
    'NA': 'kj-NA',
    'NC': 'fr-NC',
    'NE': 'ha-NE',
    'NF': 'en-NF',
    'NG': 'en-NG',
    'NI': 'es-NI',
    'NL': 'nl-NL',
    'NO': 'nb-NO',
    'NP': 'ne-NP',
    'NR': 'en-NR',
    'NU': 'en-NU',
    'NZ': 'en-NZ',
    'OM': 'ar-OM',
    'PA': 'es-PA',
    'PE': 'es-PE',
    'PF': 'fr-PF',
    'PG': 'en-PG',
    'PH': 'fil-PH',
    'PK': 'ur-PK',
    'PL': 'pl-PL',
    'PM': 'fr-PM',
    'PN': 'en-PN',
    'PR': 'es-PR',
    'PS': 'ar-PS',
    'PT': 'pt-PT',
    'PW': 'pau-PW',
    'PY': 'es-PY',
    'QA': 'ar-QA',
    'RE': 'fr-RE',
    'RO': 'ro-RO',
    'RS': 'sr-RS',
    'RU': 'ru-RU',
    'RW': 'rw-RW',
    'SA': 'ar-SA',
    'SB': 'en-SB',
    'SC': 'fr-SC',
    'SD': 'ar-SD',
    'SE': 'sv-SE',
    'SG': 'en-SG',
    'SH': 'en-SH',
    'SI': 'sl-SI',
    'SJ': 'nb-SJ',
    'SK': 'sk-SK',
    'SL': 'kri-SL',
    'SM': 'it-SM',
    'SN': 'fr-SN',
    'SO': 'so-SO',
    'SR': 'nl-SR',
    'SS': 'en-SS',
    'ST': 'pt-ST',
    'SV': 'es-SV',
    'SX': 'en-SX',
    'SY': 'ar-SY',
    'SZ': 'en-SZ',
    'TC': 'en-TC',
    'TD': 'fr-TD',
    'TF': 'fr-TF',
    'TG': 'fr-TG',
    'TH': 'th-TH',
    'TJ': 'tg-TJ',
    'TK': 'tkl-TK',
    'TL': 'pt-TL',
    'TM': 'tk-TM',
    'TN': 'ar-TN',
    'TO': 'to-TO',
    'TR': 'tr-TR',
    'TT': 'en-TT',
    'TV': 'tvl-TV',
    'TW': 'zh-Hant-TW',
    'TZ': 'sw-TZ',
    'UA': 'uk-UA',
    'UG': 'sw-UG',
    'UM': 'en-UM',
    'US': 'en-US',
    'UY': 'es-UY',
    'UZ': 'uz-UZ',
    'VA': 'it-VA',
    'VC': 'en-VC',
    'VE': 'es-VE',
    'VG': 'en-VG',
    'VI': 'en-VI',
    'VN': 'vi-VN',
    'VU': 'bi-VU',
    'WF': 'fr-WF',
    'WS': 'sm-WS',
    'XK': 'sq-XK',
    'YE': 'ar-YE',
    'YT': 'swb-YT',
    'ZA': 'en-ZA',
    'ZM': 'bem-ZM',
    'ZW': 'sn-ZW',

    'UK': 'en-GB',
}


def country_to_locale(country: str) -> str:
    code = (country or "").strip().upper()
    if not code:
        return DEFAULT_LOCALE
    return COUNTRY_TO_LOCALE.get(code, DEFAULT_LOCALE)

